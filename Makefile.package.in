BIN = ../node_modules/.bin
SRC = $(shell find src -name '*.js')

.PHONY: build install test clean

test:
	@if [ -d "test" ]; then $(BIN)/babel-node $(BIN)/tape test/*.js | $(BIN)/tap-spec; else true; fi;

clean:
	@rm -rf node_modules

check:
	@$(BIN)/flow check

build: $(SRC:src/%.js=lib/%.js)

lib/%.js: src/%.js
	@mkdir -p $(@D)
	$(BIN)/babel $< -o $@
